var car2={_events:{},_windowHeight:$(window).height(),_windowWidth:$(window).width(),_rotateNode:$(".p-ct"),_page:$(".m-page"),_pageNum:$(".m-page").size(),_pageNow:0,_pageNext:null,_touchStartValY:0,_touchDeltaY:0,_moveStart:true,_movePosition:null,_movePosition_c:null,_mouseDown:false,_moveFirst:true,_moveInit:false,_firstChange:false,_map:$(".ylmap"),_mapValue:null,_mapIndex:null,_audioNode:$(".u-audio"),_audio:null,_audio_val:true,_elementStyle:document.createElement("div").style,_UC:RegExp("Android").test(navigator.userAgent)&&RegExp("UC").test(navigator.userAgent)?true:false,_weixin:RegExp("MicroMessenger").test(navigator.userAgent)?true:false,_iPhoen:RegExp("iPhone").test(navigator.userAgent)||RegExp("iPod").test(navigator.userAgent)||RegExp("iPad").test(navigator.userAgent)?true:false,_Android:RegExp("Android").test(navigator.userAgent)?true:false,_IsPC:function(){var A=navigator.userAgent;var C=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod");var D=true;for(var B=0;B<C.length;B++){if(A.indexOf(C[B])>0){D=false;break}}return D},_isload:false,_audio_src:"",_isOwnEmpty:function(A){for(var B in A){if(A.hasOwnProperty(B)){return false}}return true},_WXinit:function(A){if(typeof window.WeixinJSBridge=="undefined"||typeof window.WeixinJSBridge.invoke=="undefined"){setTimeout(function(){this.WXinit(A)},200)}else{A()}},_vendor:function(){var C=["t","webkitT","MozT","msT","OT"],D,A=0,B=C.length;for(;A<B;A++){D=C[A]+"ransform";if(D in this._elementStyle){return C[A].substr(0,C[A].length-1)}}return false},_prefixStyle:function(A){if(this._vendor()===false){return false}if(this._vendor()===""){return A}return this._vendor()+A.charAt(0).toUpperCase()+A.substr(1)},_hasPerspective:function(){var A=this._prefixStyle("perspective") in this._elementStyle;if(A&&"webkitPerspective" in this._elementStyle){this._injectStyles("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(C,B){A=C.offsetLeft===9&&C.offsetHeight===3})}return !!A},_translateZ:function(){if(car2._hasPerspective){return" translateZ(0)"}else{return""}},_injectStyles:function(G,A,L,I){var D,J,E,K,B=document.createElement("div"),F=document.body,C=F||document.createElement("body"),H="modernizr";if(parseInt(L,10)){while(L--){E=document.createElement("div");E.id=I?I[L]:H+(L+1);B.appendChild(E)}}D=["&#173;",'<style id="s',H,'">',G,"</style>"].join("");B.id=H;(F?B:C).innerHTML+=D;C.appendChild(B);if(!F){C.style.background="";C.style.overflow="hidden";K=docElement.style.overflow;docElement.style.overflow="hidden";docElement.appendChild(C)}J=A(B,G);if(!F){C.parentNode.removeChild(C);docElement.style.overflow=K}else{B.parentNode.removeChild(B)}return !!J},_handleEvent:function(A){if(!this._events[A]){return}var B=0,C=this._events[A].length;if(!C){return}for(;B<C;B++){this._events[A][B].apply(this,[].slice.call(arguments,1))}},_on:function(A,B){if(!this._events[A]){this._events[A]=[]}this._events[A].push(B)},_scrollStop:function(){$(window).on("touchmove.scroll",this._scrollControl);$(window).on("scroll.scroll",this._scrollControl)},_scrollStart:function(){$(window).off("touchmove.scroll");$(window).off("scroll.scroll")},_scrollControl:function(A){A.preventDefault()},page_start:function(){car2._page.on("touchstart mousedown",car2.page_touch_start);car2._page.on("touchmove mousemove",car2.page_touch_move);car2._page.on("touchend mouseup",car2.page_touch_end)},page_stop:function(){car2._page.off("touchstart mousedown");car2._page.off("touchmove mousemove");car2._page.off("touchend mouseup")},page_touch_start:function(A){if(!car2.canTouchMove()){return}if(!car2._moveStart){return}if(A.type=="touchstart"){car2._touchStartValY=window.event.touches[0].pageY}else{car2._touchStartValY=A.pageY||A.y;car2._mouseDown=true}car2._moveInit=true;car2._handleEvent("start")},page_touch_move:function(B){B.preventDefault();if(!car2._moveStart){return}if(!car2._moveInit){return}var E=car2._page.eq(car2._pageNow),A=parseInt(E.height()),G,C,D=null,F=false;if(B.type=="touchmove"){G=window.event.touches[0].pageY;F=true}else{if(car2._mouseDown){G=B.pageY||B.y;F=true}else{return}}D=car2.page_position(B,G,E);car2.page_translate(D);car2._handleEvent("move")},page_position:function(B,F,D){var E,C;if(F!="undefined"){car2._touchDeltaY=F-car2._touchStartValY}car2._movePosition=F-car2._touchStartValY>0?"down":"up";if(car2._movePosition!=car2._movePosition_c){car2._moveFirst=true;car2._movePosition_c=car2._movePosition}else{car2._moveFirst=false}if(car2._touchDeltaY<=0){if(D.next(".m-page").length==0){car2._pageNext=0}else{car2._pageNext=car2._pageNow+1}C=car2._page.eq(car2._pageNext)[0]}else{if(D.prev(".m-page").length==0){if(car2._firstChange){car2._pageNext=car2._pageNum-1}else{return}}else{car2._pageNext=car2._pageNow-1}C=car2._page.eq(car2._pageNext)[0]}E=car2._page.eq(car2._pageNow)[0];node=[C,E];if(car2._moveFirst){A(node)}function A(H){var G,I,J=car2._translateZ();car2._page.removeClass("action");$(H[1]).addClass("action").removeClass("f-hide");car2._page.not(".action").addClass("f-hide");car2.height_auto(car2._page.eq(car2._pageNext),"false");$(H[0]).removeClass("f-hide").addClass("active");if(car2._movePosition=="up"){G=parseInt($(window).scrollTop());if(G>0){I=$(window).height()+G}else{I=$(window).height()}H[0].style[car2._prefixStyle("transform")]="translate(0,"+I+"px)"+J;$(H[0]).attr("data-translate",I);$(H[1]).attr("data-translate",0)}else{H[0].style[car2._prefixStyle("transform")]="translate(0,-"+Math.max($(window).height(),$(H[0]).height())+"px)"+J;$(H[0]).attr("data-translate",-Math.max($(window).height(),$(H[0]).height()));$(H[1]).attr("data-translate",0)}}return node},page_translate:function(A){if(!A){return}var C=car2._translateZ(),F,B,D,E=car2._touchDeltaY;if($(A[0]).attr("data-translate")){F=E+parseInt($(A[0]).attr("data-translate"))}A[0].style[car2._prefixStyle("transform")]="translate(0,"+F+"px)"+C;if($(A[1]).attr("data-translate")){B=E+parseInt($(A[1]).attr("data-translate"))}D=1-Math.abs(E*0.2/$(window).height());B=B/5;A[1].style[car2._prefixStyle("transform")]="translate(0,"+B+"px)"+C+" scale("+D+")"},page_touch_end:function(A){car2._moveInit=false;car2._mouseDown=false;if(!car2._moveStart){return}if(!car2._pageNext&&car2._pageNext!=0){return}car2._moveStart=false;if(Math.abs(car2._touchDeltaY)>10){car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transition")]="all .3s";car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transition")]="all .3s"}if(Math.abs(car2._touchDeltaY)>=100){car2.page_success()}else{if(Math.abs(car2._touchDeltaY)>10&&Math.abs(car2._touchDeltaY)<100){car2.page_fial()}else{car2.page_fial()}}car2._handleEvent("end");car2._movePosition=null;car2._movePosition_c=null;car2._touchStartValY=0;if($("#j-mengban").hasClass("z-show")){if(car2._pageNext==mengvalue){car2.page_stop()}}},page_success:function(){var B=car2._translateZ();car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transform")]="translate(0,0)"+B;var C=car2._touchDeltaY>0?$(window).height()/5:-$(window).height()/5;var A=0.8;car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transform")]="translate(0,"+C+"px)"+B+" scale("+A+")";car2._handleEvent("success")},page_fial:function(){var A=car2._translateZ();if(!car2._pageNext&&car2._pageNext!=0){car2._moveStart=true;car2._moveFirst=true;return}if(car2._movePosition=="up"){car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transform")]="translate(0,"+$(window).height()+"px)"+A}else{car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transform")]="translate(0,-"+$(window).height()+"px)"+A}car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transform")]="translate(0,0)"+A+" scale(1)";car2._handleEvent("fial")},haddle_envent_fn:function(){car2._on("start",car2.lazy_bigP);car2._on("move",function(){});car2._on("fial",function(){setTimeout(function(){car2._page.eq(car2._pageNow).attr("data-translate","");car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transform")]="";car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transition")]="";car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transform")]="";car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transition")]="";car2._page.eq(car2._pageNext).removeClass("active").addClass("f-hide");car2._moveStart=true;car2._moveFirst=true;car2._pageNext=null;car2._touchDeltaY=0;car2._page.eq(car2._pageNow).attr("style","")},300)});car2._on("success",function(){setTimeout(function(){if(car2._pageNext==car2._pageNum-1){$(".u-arrow").addClass("f-hide");return}else{$(".u-arrow").removeClass("f-hide")}car2._page.eq(car2._pageNow).addClass("f-hide");car2._page.eq(car2._pageNow).attr("data-translate","");car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transform")]="";car2._page.eq(car2._pageNow)[0].style[car2._prefixStyle("transition")]="";car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transform")]="";car2._page.eq(car2._pageNext)[0].style[car2._prefixStyle("transition")]="";$(".p-ct").removeClass("fixed");car2._page.eq(car2._pageNext).removeClass("active");car2._page.eq(car2._pageNext).removeClass("fixed");car2._pageNow=car2._pageNext;car2._moveStart=true;car2._moveFirst=true;car2._pageNext=null;car2._page.eq(car2._pageNow).attr("style","");car2._page.eq(car2._pageNow).removeClass("fixed");car2._page.eq(car2._pageNow).attr("data-translate","");car2._touchDeltaY=0},300)})},lazy_img:function(){var A=$(".lazy-img");A.each(function(){var C=$(this);if(C.is("img")){C.attr("src","http://img0.hx.com/magazine/img/load.gif")}else{var D=C.css("background-position"),B=C.css("background-size");C.attr({"data-position":D,"data-size":B});if(C.attr("data-bg")=="no"){C.css({"background-repeat":"no-repeat"})}C.css({"background-image":"url(http://img0.hx.com/magazine/img/load.gif)","background-size":"120px 120px","background-position":"center"});if(C.attr("data-image")=="no"){C.css({"background-image":"none"})}}})},lazy_start:function(){setTimeout(function(){for(var A=0;A<3;A++){var B=$(".m-page").eq(A);if(B.length==0){break}if(B.find(".lazy-img").length!=0){car2.lazy_change(B,false);if(B.attr("data-page-type")=="flyCon"){car2.lazy_change($(".m-flypop"),false)}}else{continue}}},200)},lazy_bigP:function(){for(var A=3;A<=5;A++){var B=$(".m-page").eq(car2._pageNow+A);if(B.length==0){break}if(B.find(".lazy-img").length!=0){car2.lazy_change(B,false);if(B.attr("data-page-type")=="flyCon"){car2.lazy_change($(".m-flypop"),false)}}else{continue}}},lazy_change:function(B,C){if(B.attr("data-page-type")=="3d"){car2.lazy_3d(B)}if(B.attr("data-page-type")=="flyCon"){var D=$(".m-flypop").find(".lazy-img");D.each(function(){var E=$(this),F=E.attr("data-src");$("<img />").on("load",function(){if(E.is("img")){E.attr("src",F)}}).attr("src",F)})}var A=B.find(".lazy-img");A.each(function(){var F=$(this),G=F.attr("data-src"),H=F.attr("data-position"),E=F.attr("data-size");if(F.attr("data-bg")!="no"){$("<img />").on("load",function(){if(F.is("img")){F.attr("src",G)}else{F.css({"background-image":"url("+G+")","background-position":H,"background-size":E})}if(C){for(var I=0;I<$(".m-page").size();I++){var J=$(".m-page").eq(I);if($(".m-page").find(".lazy-img").length==0){continue}else{car2.lazy_change(J,true)}}}}).attr("src",G);F.removeClass("lazy-img").addClass("lazy-finish")}else{if(F.attr("data-auto")=="yes"){F.css("background","none")}}})},height_auto:function(D,C){D.children(".page-con").css("height","auto");var A=$(window).height();var B=true;if(!B){if(D.height()<=A){D.children(".page-con").height(A+2);if((!$(".p-ct").hasClass("fixed"))&&C=="true"){$(".p-ct").addClass("fixed")}}else{car2._scrollStart();if(C=="true"){$(".p-ct").removeClass("fixed")}D.children(".page-con").css("height","100%");return}}else{D.children(".page-con").height(A+2);if((!$(".p-ct").hasClass("fixed"))&&C=="true"){$(".p-ct").addClass("fixed")}}},loadingPageShow:function(){$(".u-pageLoading").show()},loadingPageHide:function(){$(".u-pageLoading").hide()},refresh:function(){$(window).height()=$(window).height();car2._windowWidth=$(window).width()},canTouchMove:function(){if(car2._pageNum>1){return true}else{return false}},plugin:function(){car2.start_callback()},start_callback:function(){car2._scrollStart();car2.page_start();$(".u-arrow").removeClass("f-hide")},styleInit:function(){document.body.style.userSelect="none";document.body.style.mozUserSelect="none";document.body.style.webkitUserSelect="none";if(car2._IsPC()){$(document.body).addClass("pc")}else{$(document.body).addClass("mobile")}if(car2._Android){$(document.body).addClass("android")}if(car2._iPhoen){$(document.body).addClass("iphone")}if(!car2._hasPerspective()){car2._rotateNode.addClass("transformNode-2d");$(document.body).addClass("no-3d")}else{car2._rotateNode.addClass("transformNode-3d");$(document.body).addClass("perspective");$(document.body).addClass("yes-3d")}this.lazy_img();setTimeout(function(){$(".m-alert").find("strong").addClass("z-show")},1000);$(".u-arrow").on("touchmove",function(A){A.preventDefault()});$(".p-ct").height($(window).height());$(".m-page").height($(window).height());$("#j-mengban").height($(window).height());$(".translate-back").height($(window).height())},init:function(){this.styleInit();this.haddle_envent_fn();$('input[type="hidden"]').appendTo($("body"));$("<img />").attr("src",$("#r-cover").val());$("<img />").attr("src",$(".m-fengye").find(".page-con").attr("data-src"));var A=new Date().getTime();$(window).on("load",function(){var E=new Date().getTime();var C=false;var D;var B=E-A;if(B>=500){C=true}if(C){D=0}else{D=500-B}setTimeout(function(){setTimeout(function(){$(".m-alert").addClass("f-hide")},1000);$("#j-mengban").addClass("z-show");setTimeout(function(){$(".translate-back").removeClass("f-hide");$(".m-fengye").removeClass("f-hide");car2.height_auto(car2._page.eq(car2._pageNow),"false")},1000);car2.lazy_start();car2.plugin();$(".p-ct").height($(window).height());$(".m-page").height($(window).height());$("#j-mengban").height($(window).height());$(".translate-back").height($(window).height())},D)})}};car2.init();